# 数据预处理

## 创建人工数据
``` python
import os
os.makedirs(r'../data/basic_ops', exist_ok=True)
with open(r'../data/basic_ops/house_tiny.csv', 'w') as f:
    f.write('NumRooms,Alley,Price\n')
    f.write('NA,Pave,127500\n')
    f.write('2,NA,106000\n')
    f.write('4,NA,178100\n')
    f.write('NA,NA,140000\n')
```

## 加载数据
```python
import pandas as pd
data = pd.read_csv(r'../data/basic_ops/house_tiny.csv')
data
```
输出:
```
   NumRooms Alley   Price
0       NaN  Pave  127500
1       2.0   NaN  106000
2       4.0   NaN  178100
3       NaN   NaN  140000
```

## 处理缺失值
```python
inputs,outputs = data.iloc[:,0:2],data.iloc[:,2]
inputs['NumRooms'] = inputs['NumRooms'].fillna(inputs['NumRooms'].mean())
inputs
```
输出:
```
   NumRooms Alley
0       3.0  Pave
1       2.0   NaN
2       4.0   NaN
3       3.0   NaN
```

## 对非数值类型进行分类

```python
inputs = pd.get_dummies(inputs,dummy_na=True)
inputs = inputs.astype('float32')
inputs
```
输出:
```
   NumRooms  Alley_Pave  Alley_nan
0       3.0        1.0        0.0
1       2.0        0.0        1.0
2       4.0        0.0        1.0
3       3.0        0.0        1.0
```

## 转化为张量

```pyhton
import torch
x,y = torch.tensor(inputs.values), torch.tensor(outputs.values)
x,y
```
输出:
```
(tensor([[3., 1., 0.],
         [2., 0., 1.],
         [4., 0., 1.],
         [3., 0., 1.]]),
 tensor([127500, 106000, 178100, 140000]))
```
## 思考
再一次复习了python数据分析的读取数据，处理缺失值